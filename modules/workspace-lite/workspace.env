frunction run_if_defined() {
    type -f $1 \
        1 > /dev/null \
        2 > /dev/null \
        && $1
}

function cd_with_rc() {
    run_if_defined on_exit
    \cd $@
    unset -f on_exit 2>/dev/null
    unset -f on_enter 2>/dev/null
    [[ -a $PWD/.envrc ]] && source .envrc
    run_if_defined on_enter
}

alias cd=cd_with_rc
